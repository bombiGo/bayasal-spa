(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{324:function(e,t,r){"use strict";r.r(t);r(5),r(105),r(57);var o=r(19),n={data:function(){return{editorOption:{bounds:"app",placeholder:"",modules:{toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["image"]]}}},editorHeight:0,editorOpacity:0,editorPointerEvents:"none",loading:!1,isBusy:!1,courseDayNumber:0,courseDayCalendar:"",daySelected:"select",contentSelected:"youtube",contentOptions:[{item:"youtube",name:"Видео"},{item:"file",name:"Файл"},{item:"editor",name:"Текст зураг"}],fileUrl:"",form:{title:"",dayNumber:"",dayCalendar:"",content:"",file:null,youtube:"",duration:"",locked:"unlocked"}}},created:function(){this.fetchData(),this.daySelected=this.$route.query.dayMode,"select"===this.$route.query.dayMode&&(isNaN(this.$route.query.dayNumber)||(this.courseDayNumber=parseInt(this.$route.query.dayNumber)))},filters:{truncate:function(text,e,t){return text.length>e?text.substring(0,e)+t:text}},methods:{fetchData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isBusy=!0,t.prev=1,t.next=4,e.$axios.get("/lessons/edit?id="+e.$route.params.id2);case 4:(r=t.sent).data&&e.setFormData(r.data),e.isBusy=!1,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),e.isBusy=!1,console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},setFormData:function(data){this.form.title=data.title?data.title.S:"",this.form.dayNumber=data.dayNumber?parseInt(data.dayNumber.S):"",this.form.duration=data.duration?data.duration.S:"",data.locked&&data.locked.BOOL&&(this.form.locked=new Boolean(data.locked.BOOL)?"locked":"unlocked"),data.contentMode&&data.contentMode.S&&(this.contentSelected=data.contentMode.S,"youtube"==this.contentSelected&&(this.form.youtube=data.youtube.S),"editor"==this.contentSelected&&(this.form.content=data.content.S),"file"==this.contentSelected&&(this.fileUrl=data.file.S))},onEditorChange:function(e){e.editor;var html=e.html;e.text;this.form.content=html},checkImageUrl:function(e){return null!=e.match(/\.(jpeg|jpg|gif|png)$/)},onSubmit:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o,n,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={"Content-Type":"multipart/form-data"},o=e.form.file?"uploaded":"no_upload","editor"!==e.contentSelected&&(e.form.content=""),(n=new FormData).append("pk",e.$route.params.id2),n.append("title",e.form.title),n.append("contentMode",e.contentSelected),n.append("file",e.form.file),n.append("fileUpload",o),n.append("oldFile",e.fileUrl),n.append("youtube",e.form.youtube),n.append("content",e.form.content),n.append("dayNumber",e.form.dayNumber),n.append("dayCalendar",e.form.dayCalendar),n.append("locked",e.form.locked),n.append("duration",e.form.duration),t.prev=16,t.next=19,e.$axios.post("/lessons/edit",n,r);case 19:(l=t.sent).data.success?e.$router.push({name:"courses-id-show",params:{id:e.$route.params.id}}):alert("Lesson update error"),e.loading=!1,console.log(l),t.next=29;break;case 25:t.prev=25,t.t0=t.catch(16),e.loading=!1,console.log(t.t0);case 29:case"end":return t.stop()}}),t,null,[[16,25]])})))()}},watch:{daySelected:function(){this.form.day=""},contentSelected:function(e){"editor"===e?(this.editorOpacity=1,this.editorHeight=250,this.editorPointerEvents="auto"):(this.editorOpacity=0,this.editorHeight=0,this.editorPointerEvents="none")}}},l=r(48),component=Object(l.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-fliud"},[r("div",{staticClass:"content p-3"},[r("nav",{attrs:{"aria-label":"breadcrumb"}},[r("ol",{staticClass:"breadcrumb"},[r("li",{staticClass:"breadcrumb-item"},[r("nuxt-link",{attrs:{to:"/home"}},[e._v("Нүүр")])],1),e._v(" "),r("li",{staticClass:"breadcrumb-item"},[r("nuxt-link",{attrs:{to:"/courses"}},[e._v("Хөтөлбөрүүд")])],1),e._v(" "),r("li",{staticClass:"breadcrumb-item"},[r("nuxt-link",{attrs:{to:{name:"courses-id-show",params:{id:e.$route.params.id}}}},[e._v("\n              "+e._s(e._f("truncate")(e.$route.query.title,20,"..."))+"\n            ")])],1),e._v(" "),r("li",{staticClass:"breadcrumb-item active",attrs:{"aria-current":"page"}},[e._v("Хичээл засах")])])]),e._v(" "),e.isBusy?e._e():r("b-form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("b-card",{attrs:{"bg-variant":"light","text-variant":"dark"},scopedSlots:e._u([{key:"header",fn:function(){return[r("h6",{staticClass:"float-left"},[e._v("Хичээл засах")]),e._v(" "),r("div",{staticClass:"float-right"},[e.loading?e._e():r("b-button",{attrs:{variant:"primary",type:"submit"}},[e._v("\n                Хадгалах\n              ")]),e._v(" "),e.loading?r("b-button",{attrs:{variant:"primary",disabled:""}},[r("b-spinner",{attrs:{small:""}}),e._v(" "),r("span",{staticClass:"sr-only"},[e._v("Loading...")])],1):e._e()],1)]},proxy:!0}],null,!1,1699312134)},[e._v(" "),r("b-form-group",{attrs:{label:"Өдөр сонгох"}},["select"===e.$route.query.dayMode?r("b-form-select",{attrs:{required:""},model:{value:e.form.dayNumber,callback:function(t){e.$set(e.form,"dayNumber",t)},expression:"form.dayNumber"}},[r("option",{attrs:{value:""}},[e._v("-- Сонгох --")]),e._v(" "),e._l(e.courseDayNumber,(function(t,o){return r("option",{key:o,domProps:{value:t}},[e._v("\n                "+e._s(t)+" өдөр\n              ")])}))],2):e._e(),e._v(" "),"calendar"===e.$route.query.dayMode?r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.dayCalendar,expression:"form.dayCalendar"}],staticClass:"form-control",attrs:{type:"date"},domProps:{value:e.form.dayCalendar},on:{input:function(t){t.target.composing||e.$set(e.form,"dayCalendar",t.target.value)}}}):e._e()],1),e._v(" "),r("b-form-group",{attrs:{id:"input-group-1",label:"Хичээлийн гарчиг","label-for":"input-1"}},[r("b-form-input",{attrs:{id:"input-1",required:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),r("b-form-radio-group",{staticClass:"mb-3",attrs:{options:e.contentOptions,"value-field":"item","text-field":"name","disabled-field":"notEnabled"},model:{value:e.contentSelected,callback:function(t){e.contentSelected=t},expression:"contentSelected"}}),e._v(" "),"youtube"===e.contentSelected?r("b-form-group",{attrs:{id:"input-youtube"}},[r("b-form-input",{attrs:{id:"input-youtube",type:"text",placeholder:"Video"},model:{value:e.form.youtube,callback:function(t){e.$set(e.form,"youtube",t)},expression:"form.youtube"}})],1):e._e(),e._v(" "),"file"===e.contentSelected?r("b-form-group",[r("b-form-file",{attrs:{placeholder:"Pdf, excel, image ..."},model:{value:e.form.file,callback:function(t){e.$set(e.form,"file",t)},expression:"form.file"}})],1):e._e(),e._v(" "),"youtube"===e.contentSelected&&e.form.youtube?r("div",{staticClass:"m-3"},[r("iframe",{attrs:{src:"https://player.vimeo.com/video/"+e.form.youtube,width:"360",frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:""}})]):e._e(),e._v(" "),"file"===e.contentSelected&&e.fileUrl?r("div",{staticClass:"m-3"},[e.checkImageUrl(this.fileUrl)?r("img",{staticClass:"img-fluid",staticStyle:{"max-width":"100px"},attrs:{src:e.fileUrl}}):r("div",[r("object",{attrs:{data:e.fileUrl,type:"application/pdf",width:"500",height:"678"}},[r("iframe",{attrs:{src:e.fileUrl,width:"300",height:"300"}},[r("p",[e._v("This browser does not support PDF!")])])])])]):e._e(),e._v(" "),r("b-form-group",{attrs:{id:"input-duration",label:"Хугацаа/Хэмжээ"}},[r("b-form-input",{attrs:{id:"input-youtube",type:"text",placeholder:"Файл - 10 миниут, 3kb"},model:{value:e.form.duration,callback:function(t){e.$set(e.form,"duration",t)},expression:"form.duration"}})],1),e._v(" "),r("b-form-checkbox",{attrs:{id:"checkbox-lesson",value:"locked","unchecked-value":"unlocked"},model:{value:e.form.locked,callback:function(t){e.$set(e.form,"locked",t)},expression:"form.locked"}},[e._v("\n            Хичээл түгжих / нээх\n          ")]),e._v(" "),r("div",{staticClass:"mt-3",style:{opacity:e.editorOpacity+" !important","pointer-events":e.editorPointerEvents}},[r("div",{directives:[{name:"quill",rawName:"v-quill:myQuillEditor",value:e.editorOption,expression:"editorOption",arg:"myQuillEditor"}],staticClass:"quill-editor",staticStyle:{"background-color":"white"},style:{height:e.editorHeight+"px"},attrs:{content:e.form.content},on:{change:function(t){return e.onEditorChange(t)}}})])],1)],1),e._v(" "),e.isBusy?r("p",[e._v("Уншиж байна ...")]):e._e()],1)])}),[],!1,null,null,null);t.default=component.exports}}]);