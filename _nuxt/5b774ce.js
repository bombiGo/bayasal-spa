(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{303:function(e,t,n){"use strict";n.r(t);n(3),n(103),n(8),n(9),n(57);var r=n(19),o={middleware:["auth"],data:function(){return{loading:!1,infos:[],infoCategories:[],deleteInfo:{confirmMessage:"",isBusy:!1,pk:"",disabled:!0}}},created:function(){this.$store.getters.user.token?this.fetchData():this.$router.push("/home")},methods:{fetchData:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.$axios.get("/infos");case 4:n=t.sent,e.loading=!1,n.data.success&&(e.infoCategories=n.data.info_categories,e.infos=n.data.infos.filter((function(data){return"info"===data.SK.S})),r=n.data.infos.filter((function(data){return"category"===data.SK.S})),e.$store.commit("setInfoCategories",r)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),e.loading=!1,console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},remove:function(e){this.deleteInfo.pk=e,this.$refs["delete-modal"].show()},getCategoryNames:function(e){var t=this,n=[];return this.infoCategories.forEach((function(r){if(e==r.InfoId.S){var o=t.$store.getters.infoCategories.find((function(data){return data.PK.S==r.CategoryId.S}));o&&n.push(o.title.S)}})),n},deleteOk:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.preventDefault(),!t.deleteInfo.pk){n.next=19;break}return t.deleteInfo.confirmMessage="",t.deleteInfo.isBusy=!0,n.prev=4,n.next=7,t.$axios.delete("/infos?pk="+t.deleteInfo.pk);case 7:r=n.sent,t.deleteInfo.isBusy=!1,r.data.success?(t.$refs["delete-modal"].hide(),t.fetchData()):alert("Info delete error"),console.log(r),n.next=17;break;case 13:n.prev=13,n.t0=n.catch(4),t.deleteInfo.isBusy=!1,console.log(n.t0);case 17:n.next=20;break;case 19:alert("Info delete error");case 20:case"end":return n.stop()}}),n,null,[[4,13]])})))()}},watch:{"deleteInfo.confirmMessage":function(e){this.deleteInfo.disabled="permanently delete"!==e}}},l=n(48),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container-fliud"},[n("div",{staticClass:"content p-3"},[n("h5",[e._v("Нийт мэдээлэлүүд ("+e._s(e.infos.length)+")")]),e._v(" "),e.loading?e._e():n("b-button",{staticClass:"mt-3",attrs:{pill:"",variant:"success",to:"/infos/add"}},[e._v("Мэдээлэл нэмэх")]),e._v(" "),n("div",{staticClass:"table-responsive mt-3"},[n("table",{staticClass:"table"},[e._m(0),e._v(" "),n("tbody",[e.loading?e._e():e._l(e.infos,(function(t){return n("tr",{key:t.PK.S},[n("td",[n("img",{staticClass:"img-fluid",staticStyle:{"max-width":"100px"},attrs:{src:t.image.S}})]),e._v(" "),n("td",[n("nuxt-link",{attrs:{to:{name:"infos-id-show",params:{id:t.PK.S}}}},[e._v("\n                    "+e._s(t.title.S)+"\n                  ")])],1),e._v(" "),n("td",["category_news"==t.type.S?n("b-badge",{attrs:{variant:"info"}},[e._v("\n                    Мэдээлэл\n                  ")]):e._e(),e._v(" "),"category_advice"==t.type.S?n("b-badge",{attrs:{variant:"secondary"}},[e._v("\n                    Зөвлөмж\n                  ")]):e._e(),e._v(" "),"category_exercise"==t.type.S?n("b-badge",{attrs:{variant:"warning"}},[e._v("\n                    Дасгал\n                  ")]):e._e()],1),e._v(" "),n("td",[e.getCategoryNames(t.PK.S)&&e.getCategoryNames(t.PK.S).length>0?n("div",e._l(e.getCategoryNames(t.PK.S),(function(t,r){return n("b-badge",{key:r,staticClass:"mr-2",attrs:{variant:"warning"}},[n("span",[e._v(e._s(t))])])})),1):e._e()]),e._v(" "),n("td",[t.featured&&t.featured.BOOL?n("span",[e._v("Тийм")]):n("span",[e._v("Үгүй")])]),e._v(" "),n("td",[n("b-button",{staticClass:"mb-2",attrs:{variant:"primary",size:"sm",to:{name:"infos-id-edit",params:{id:t.PK.S}}}},[e._v("Засах")]),e._v(" "),n("b-button",{staticClass:"mb-2",attrs:{variant:"danger",size:"sm"},on:{click:function(n){return e.remove(t.PK.S)}}},[e._v("Устгах")])],1)])})),e._v(" "),e.loading?[n("p",{staticClass:"p-3"},[e._v("Уншиж байна ...")])]:e._e()],2)])]),e._v(" "),n("b-modal",{ref:"delete-modal",attrs:{size:"sm",title:"Мэдээлэл устгах уу"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[n("div",{staticClass:"w-100"},[n("b-button",{staticClass:"float-right",attrs:{variant:"primary",size:"md",disabled:e.deleteInfo.disabled},on:{click:e.deleteOk}},[e.deleteInfo.isBusy?n("b-spinner",{attrs:{small:""}}):e._e(),e._v(" "),e.deleteInfo.isBusy?n("span",{staticClass:"sr-only"},[e._v("Loading...")]):e._e(),e._v(" "),e.deleteInfo.isBusy?e._e():n("span",[e._v("Устгах")])],1)],1)]},proxy:!0}])},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.deleteInfo.confirmMessage,expression:"deleteInfo.confirmMessage"}],staticClass:"form-control",attrs:{type:"text",placeholder:"permanently delete"},domProps:{value:e.deleteInfo.confirmMessage},on:{input:function(t){t.target.composing||e.$set(e.deleteInfo,"confirmMessage",t.target.value)}}})])],1)])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",{staticClass:"thead-light"},[n("tr",[n("th",{attrs:{scope:"col"}},[e._v("Зураг")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Нэр")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Төрөл")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Ангилал")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Онцлох")]),e._v(" "),n("th",{attrs:{scope:"col"}})])])}],!1,null,null,null);t.default=component.exports}}]);