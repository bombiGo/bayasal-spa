(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{299:function(e,t,r){"use strict";r.r(t);r(104),r(16),r(5),r(26),r(12),r(57);var o=r(19),n={middleware:["auth"],data:function(){return{loading:!1,courses:[],deleteCourse:{confirmMessage:"",isBusy:!1,id:"",disabled:!0}}},created:function(){this.$store.getters.user.token?this.fetchData():this.$router.push("/home")},filters:{formatPrice:function(e){return(e/1).toFixed(0).replace(".",",").toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}},methods:{fetchData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.$axios.get("/courses");case 4:r=t.sent,e.loading=!1,e.courses=r.data,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),e.loading=!1,console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},remove:function(title,e){this.deleteCourse.id=e,this.$refs["delete-modal"].show()},deleteOk:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.preventDefault(),!t.deleteCourse.id){r.next=18;break}return t.deleteCourse.isBusy=!0,r.prev=3,r.next=6,t.$axios.delete("/courses/single-delete?id="+t.deleteCourse.id);case 6:o=r.sent,t.deleteCourse.isBusy=!1,o.data.success?(t.$refs["delete-modal"].hide(),t.fetchData()):alert("Course delete error"),console.log(o),r.next=16;break;case 12:r.prev=12,r.t0=r.catch(3),t.deleteCourse.isBusy=!1,console.log(r.t0);case 16:r.next=19;break;case 18:alert("Delete action error");case 19:case"end":return r.stop()}}),r,null,[[3,12]])})))()}},watch:{"deleteCourse.confirmMessage":function(e){this.deleteCourse.disabled="permanently delete"!==e}}},l=r(48),component=Object(l.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-fliud"},[r("div",{staticClass:"content p-3"},[r("h5",[e._v("Хөтөлбөрүүд ("+e._s(e.courses.length)+")")]),e._v(" "),r("b-button",{staticClass:"mt-3",attrs:{pill:"",variant:"success",to:"/courses/add"}},[e._v("Хөтөлбөр нэмэх")]),e._v(" "),r("div",{staticClass:"table-responsive mt-3"},[r("table",{staticClass:"table"},[e._m(0),e._v(" "),r("tbody",[e.loading?e._e():e._l(e.courses,(function(t){return r("tr",{key:t.id.S},[r("td",[r("img",{staticClass:"img-fluid",attrs:{src:t.image.S,width:"100"}})]),e._v(" "),r("td",[r("nuxt-link",{attrs:{to:{name:"courses-id-show",params:{id:t.id.S}}}},[e._v(e._s(t.title.S))])],1),e._v(" "),r("td",[r("strong",[e._v(e._s(e._f("formatPrice")(t.price.S)))])]),e._v(" "),r("td",[r("b-badge",{staticClass:"p-2",attrs:{pill:"",variant:"info"}},[e._v(e._s(t.day1.S)+" өдөр")])],1),e._v(" "),r("td",[e._v("\n                  "+e._s(t.createdAt.S)+"\n                ")]),e._v(" "),r("td",[r("b-button",{staticClass:"mb-2",attrs:{variant:"primary",size:"sm",to:{name:"courses-id-edit",params:{id:t.id.S}}}},[e._v("Засах")]),e._v(" "),r("b-button",{staticClass:"mb-2",attrs:{variant:"danger",size:"sm"},on:{click:function(r){return e.remove(t.title.S,t.id.S)}}},[e._v("Устгах")])],1)])})),e._v(" "),e.loading?[r("p",{staticClass:"p-3"},[e._v("Уншиж байна ...")])]:e._e()],2)])]),e._v(" "),r("b-modal",{ref:"delete-modal",attrs:{size:"sm",title:"Хөтөлбөрийг устгах уу"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[r("div",{staticClass:"w-100"},[r("b-button",{staticClass:"float-right",attrs:{variant:"primary",size:"md",disabled:e.deleteCourse.disabled},on:{click:e.deleteOk}},[e.deleteCourse.isBusy?r("b-spinner",{attrs:{small:""}}):e._e(),e._v(" "),e.deleteCourse.isBusy?r("span",{staticClass:"sr-only"},[e._v("Loading...")]):e._e(),e._v(" "),e.deleteCourse.isBusy?e._e():r("span",[e._v("Устгах")])],1)],1)]},proxy:!0}])},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.deleteCourse.confirmMessage,expression:"deleteCourse.confirmMessage"}],staticClass:"form-control",attrs:{type:"text",placeholder:"permanently delete"},domProps:{value:e.deleteCourse.confirmMessage},on:{input:function(t){t.target.composing||e.$set(e.deleteCourse,"confirmMessage",t.target.value)}}})])],1)])}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",{staticClass:"thead-light"},[r("tr",[r("th",{attrs:{scope:"col"}},[e._v("Зураг")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Нэр")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Үнэ")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Өдөр")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Бүртгэгдсэн")]),e._v(" "),r("th",{attrs:{scope:"col"}})])])}],!1,null,null,null);t.default=component.exports}}]);